# Carte tableau de bord moderne BMW iX3
# √Ä ajouter dans votre dashboard

type: vertical-stack
cards:
  # En-t√™te avec logo et statut
  - type: custom:mushroom-template-card
    primary: BMW iX3
    secondary: |
      {% if is_state('sensor.bmw_ix3_charging_status', 'CHARGING') %}
        ‚ö° En charge - {{ states('sensor.bmw_ix3_battery_level') }}%
      {% elif is_state('sensor.bmw_ix3_charging_status', 'COMPLETE') %}
        ‚úÖ Charg√©e - {{ states('sensor.bmw_ix3_battery_level') }}%
      {% else %}
        üîå Pr√™te - {{ states('sensor.bmw_ix3_battery_level') }}%
      {% endif %}
    icon: mdi:car-electric
    icon_color: |
      {% if is_state('sensor.bmw_ix3_charging_status', 'CHARGING') %}
        green
      {% elif is_state('sensor.bmw_ix3_charging_status', 'COMPLETE') %}
        blue
      {% else %}
        grey
      {% endif %}
    layout: horizontal
    card_mod:
      style: |
        ha-card {
          {% if is_state('sensor.bmw_ix3_charging_status', 'CHARGING') %}
            animation: pulse 2s ease-in-out infinite;
          {% endif %}
        }
        @keyframes pulse {
          0%, 100% { box-shadow: 0 0 10px rgba(76, 175, 80, 0.5); }
          50% { box-shadow: 0 0 20px rgba(76, 175, 80, 1); }
        }
  
  # Statistiques principales
  - type: glance
    entities:
      - entity: sensor.bmw_ix3_battery_level
        name: Batterie
        icon: mdi:battery
      - entity: sensor.bmw_ix3_range_electric
        name: Autonomie
        icon: mdi:map-marker-distance
      - entity: sensor.bmw_ix3_charging_power
        name: Puissance
        icon: mdi:lightning-bolt
    show_state: true
    columns: 3
    card_mod:
      style: |
        ha-card {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
        }
  
  # Tableau des temps de charge
  - type: markdown
    content: |
      ## ‚è±Ô∏è Temps de charge estim√©
      
      | Puissance | 80% | 100% |
      |-----------|-----|------|
      | **3.7 kW** | {{ states('sensor.bmw_ix3_charge_time_80_3_7kw') }} | {{ states('sensor.bmw_ix3_charge_time_100_3_7kw') }} |
      | **7.4 kW** | {{ states('sensor.bmw_ix3_charge_time_80_7_4kw') }} | {{ states('sensor.bmw_ix3_charge_time_100_7_4kw') }} |
      | **11 kW** | {{ states('sensor.bmw_ix3_charge_time_80_11kw') }} | {{ states('sensor.bmw_ix3_charge_time_100_11kw') }} |
      | **22 kW** | {{ states('sensor.bmw_ix3_charge_time_80_22kw') }} | {{ states('sensor.bmw_ix3_charge_time_100_22kw') }} |
      
      ---
      
      üí° **Recommandation** : Charge √† 80% pour pr√©server la batterie
    card_mod:
      style: |
        ha-card {
          background: rgba(255, 255, 255, 0.05);
          backdrop-filter: blur(10px);
        }
        ha-markdown {
          padding: 16px;
        }
        table {
          width: 100%;
          border-collapse: collapse;
        }
        th, td {
          padding: 8px;
          text-align: center;
          border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        th {
          font-weight: bold;
          background: rgba(255,255,255,0.1);
        }
  
  # Contr√¥les
  - type: entities
    title: üéõÔ∏è Contr√¥les
    entities:
      - entity: switch.bmw_ix3_auto_stop_80_percent
        name: Arr√™t automatique √† 80%
        icon: mdi:battery-80
      - entity: number.bmw_ix3_target_soc
        name: SOC cible
        icon: mdi:battery-charging
      - entity: number.bmw_ix3_departure_time
        name: Heure de d√©part
        icon: mdi:clock-outline
    card_mod:
      style: |
        ha-card {
          border-radius: 15px;
        }
  
  # Graphique historique (si vous avez le recorder activ√©)
  - type: custom:mini-graph-card
    entities:
      - entity: sensor.bmw_ix3_battery_level
        name: Batterie
        color: '#4CAF50'
      - entity: sensor.bmw_ix3_range_electric
        name: Autonomie
        color: '#2196F3'
        y_axis: secondary
    hours_to_show: 24
    points_per_hour: 4
    line_width: 3
    font_size: 75
    animate: true
    show:
      fill: fade
      icon: false
      name: false
      state: false
    card_mod:
      style: |
        ha-card {
          border-radius: 15px;
          background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
        }

# Style g√©n√©ral du groupe
card_mod:
  style: |
    ha-card {
      gap: 10px;
    }

